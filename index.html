<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pi Login Token</title>
  <script src="https://sdk.minepi.com/pi-sdk.js"></script>
</head>
<body>
  <h1>Pi Login - Lấy Access Token</h1>
  <button id="loginBtn">Login with Pi</button>
  <pre id="log"></pre>

  <script>
    const logEl = document.getElementById("log");
    function log(msg) {
      logEl.textContent += msg + "\n";
      console.log(msg);
    }

    // Production mode (sandbox = false)
    Pi.init({ version: "2.0", sandbox: false });

    document.getElementById("loginBtn").addEventListener("click", async () => {
      log("🔄 Bắt đầu login...");
      try {
        // Chỉ yêu cầu username
        const scopes = ['username']; 
        const user = await Pi.authenticate(scopes);

        log("✅ Đăng nhập thành công:");
        log(JSON.stringify(user, null, 2));

        // Access token sẽ nằm trong user.accessToken
        if (user.accessToken) {
          log("🔑 Access Token:");
          log(user.accessToken);
          alert("Copy Access Token từ console hoặc log trên trang");
        } else {
          log("⚠️ Không tìm thấy access token");
        }

      } catch (err) {
        log("❌ Lỗi login: " + err);
      }
    });
  </script>
</body>
</html>
